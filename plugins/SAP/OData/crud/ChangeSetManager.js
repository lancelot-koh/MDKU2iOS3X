"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ErrorMessage_1 = require("../../ErrorHandling/ErrorMessage");
var ODataHelper_1 = require("../ODataHelper");
var ChangeSetManager = /** @class */ (function () {
    function ChangeSetManager(dataService) {
        this.service = dataService;
        this.pendingEntityReadLinkOrdinalSuffix = 0;
        this.pendingChangeSet = null;
    }
    ChangeSetManager.isPending = function (entity) {
        var readLink = entity.getReadLink();
        return readLink == null || readLink.startsWith(ChangeSetManager.UNPROCESSEDPREFIX);
    };
    ChangeSetManager.prototype.beginChangeSet = function () {
        if (this.pendingChangeSet != null) {
            throw new Error(ErrorMessage_1.ErrorMessage.ODATA_CHANGESET_ALREADY_EXISTS);
        }
        this.pendingChangeSet = ODataHelper_1.ODataHelper.createChangeSet();
        this.pendingEntityReadLinkOrdinalSuffix = 0;
    };
    ChangeSetManager.prototype.cancelChangeSet = function () {
        this.pendingChangeSet = null;
        this.pendingEntityReadLinkOrdinalSuffix = 0;
    };
    ChangeSetManager.prototype.commitChangeSet = function () {
        var changeSet = this.pendingChangeSet;
        if (changeSet == null) {
            throw new Error(ErrorMessage_1.ErrorMessage.ODATA_COMMIT_EMPTY_CHANGESET_NOT_ALLOWED);
        }
        this.pendingChangeSet = null;
        this.pendingEntityReadLinkOrdinalSuffix = 0;
        this.processBatchWithChangeSet(changeSet);
    };
    ChangeSetManager.prototype.createEntity = function (entity, headers) {
        var changeSet = this.pendingChangeSet;
        if (changeSet != null) {
            this.pendingEntityReadLinkOrdinalSuffix += 1;
            entity.setReadLink(ChangeSetManager.UNPROCESSEDPREFIX + this.pendingEntityReadLinkOrdinalSuffix);
            changeSet.createEntity(entity, headers);
        }
        else {
            this.service.createEntity(entity, headers);
        }
    };
    ChangeSetManager.prototype.createRelatedEntity = function (entity, parentEntity, parentNavProp, headers) {
        var changeSet = this.pendingChangeSet;
        if (changeSet != null) {
            this.pendingEntityReadLinkOrdinalSuffix += 1;
            entity.setReadLink(ChangeSetManager.UNPROCESSEDPREFIX + this.pendingEntityReadLinkOrdinalSuffix);
            changeSet.createRelatedEntity(entity, parentEntity, parentNavProp, headers);
        }
        else {
            this.service.createRelatedEntity(entity, parentEntity, parentNavProp, headers);
        }
    };
    ChangeSetManager.prototype.updateEntity = function (entity, headers) {
        var changeSet = this.pendingChangeSet;
        if (changeSet != null) {
            changeSet.updateEntity(entity, headers);
        }
        else {
            this.service.updateEntity(entity, headers);
        }
    };
    ChangeSetManager.prototype.deleteEntity = function (entity, headers) {
        var changeSet = this.pendingChangeSet;
        if (changeSet != null) {
            changeSet.deleteEntity(entity, headers);
        }
        else {
            this.service.deleteEntity(entity, headers);
        }
    };
    ChangeSetManager.prototype.pendingEntityFromPendingChangeSet = function (readLink) {
        if (!readLink.startsWith(ChangeSetManager.UNPROCESSEDPREFIX)) {
            return null;
        }
        return ODataHelper_1.ODataHelper.entityWithReadLink(this.pendingChangeSet, readLink);
    };
    ChangeSetManager.prototype.processBatchWithChangeSet = function (changeSet) {
        var requestBatch = ODataHelper_1.ODataHelper.createRequestBatch();
        requestBatch.addChanges(changeSet);
        this.service.processBatch(requestBatch);
        var error = changeSet.getError();
        if (error != null) {
            throw error;
        }
    };
    ChangeSetManager.UNPROCESSEDPREFIX = 'pending_';
    return ChangeSetManager;
}());
exports.ChangeSetManager = ChangeSetManager;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2hhbmdlU2V0TWFuYWdlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkNoYW5nZVNldE1hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpRUFBZ0U7QUFDaEUsOENBQTZDO0FBRTdDO0lBWUUsMEJBQVksV0FBZ0I7UUFDMUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxXQUFXLENBQUM7UUFDM0IsSUFBSSxDQUFDLGtDQUFrQyxHQUFHLENBQUMsQ0FBQztRQUM1QyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDO0lBQy9CLENBQUM7SUFiYSwwQkFBUyxHQUF2QixVQUF3QixNQUFXO1FBQ2pDLElBQUksUUFBUSxHQUFHLE1BQU0sQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNwQyxNQUFNLENBQUMsUUFBUSxJQUFJLElBQUksSUFBSSxRQUFRLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFDckYsQ0FBQztJQVlNLHlDQUFjLEdBQXJCO1FBQ0UsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixJQUFJLElBQUksQ0FBQyxDQUFFLENBQUM7WUFDbkMsTUFBTSxJQUFJLEtBQUssQ0FBQywyQkFBWSxDQUFDLDhCQUE4QixDQUFDLENBQUM7UUFDL0QsQ0FBQztRQUNELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyx5QkFBVyxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3RELElBQUksQ0FBQyxrQ0FBa0MsR0FBRyxDQUFDLENBQUM7SUFDOUMsQ0FBQztJQUVNLDBDQUFlLEdBQXRCO1FBQ0UsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQztRQUM3QixJQUFJLENBQUMsa0NBQWtDLEdBQUcsQ0FBQyxDQUFDO0lBQzlDLENBQUM7SUFFTSwwQ0FBZSxHQUF0QjtRQUNFLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQztRQUN0QyxFQUFFLENBQUMsQ0FBQyxTQUFTLElBQUksSUFB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QUM7WUFDN0QsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNkLENBQUM7UUFDRCxNQUFNLENBQUMseUJBQVcsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDekUsQ0FBQztJQUVPLG9EQUF5QixHQUFqQyxVQUFrQyxTQUFjO1FBQzlDLElBQUksWUFBWSxHQUFHLHlCQUFXLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUNwRCxZQUFZLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRW5DLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3hDLElBQUksS0FBSyxHQUFHLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNqQyxFQUFFLENBQUMsQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztZQUNsQixNQUFNLEtBQUssQ0FBQztRQUNkLENBQUM7SUFDSCxDQUFDO0lBakdhLGtDQUFpQixHQUFXLFVBQVUsQ0FBQztJQWtHdkQsdUJBQUM7Q0FBQSxBQW5HRCxJQW1HQztBQW5HWSw0Q0FBZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFcnJvck1lc3NhZ2UgfSBmcm9tICcuLi8uLi9FcnJvckhhbmRsaW5nL0Vycm9yTWVzc2FnZSc7XG5pbXBvcnQgeyBPRGF0YUhlbHBlciB9IGZyb20gJy4uL09EYXRhSGVscGVyJztcblxuZXhwb3J0IGNsYXNzIENoYW5nZVNldE1hbmFnZXIge1xuICBwdWJsaWMgc3RhdGljIFVOUFJPQ0VTU0VEUFJFRklYOiBzdHJpbmcgPSAncGVuZGluZ18nOyAgXG5cbiAgcHVibGljIHN0YXRpYyBpc1BlbmRpbmcoZW50aXR5OiBhbnkpOiBib29sZWFuIHtcbiAgICBsZXQgcmVhZExpbmsgPSBlbnRpdHkuZ2V0UmVhZExpbmsoKTtcbiAgICByZXR1cm4gcmVhZExpbmsgPT0gbnVsbCB8fCByZWFkTGluay5zdGFydHNXaXRoKENoYW5nZVNldE1hbmFnZXIuVU5QUk9DRVNTRURQUkVGSVgpO1xuICB9XG5cbiAgcHJpdmF0ZSBwZW5kaW5nQ2hhbmdlU2V0OiBhbnk7XG4gIHByaXZhdGUgcGVuZGluZ0VudGl0eVJlYWRMaW5rT3JkaW5hbFN1ZmZpeDogbnVtYmVyO1xuICBwcml2YXRlIHNlcnZpY2U6IGFueTtcblxuICBjb25zdHJ1Y3RvcihkYXRhU2VydmljZTogYW55KSB7XG4gICAgdGhpcy5zZXJ2aWNlID0gZGF0YVNlcnZpY2U7XG4gICAgdGhpcy5wZW5kaW5nRW50aXR5UmVhZExpbmtPcmRpbmFsU3VmZml4ID0gMDtcbiAgICB0aGlzLnBlbmRpbmdDaGFuZ2VTZXQgPSBudWxsO1xuICB9XG5cbiAgcHVibGljIGJlZ2luQ2hhbmdlU2V0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnBlbmRpbmdDaGFuZ2VTZXQgIT0gbnVsbCkgIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihFcnJvck1lc3NhZ2UuT0RBVEFfQ0hBTkdFU0VUX0FMUkVBRFlfRVhJU1RTKTtcbiAgICB9XG4gICAgdGhpcy5wZW5kaW5nQ2hhbmdlU2V0ID0gT0RhdGFIZWxwZXIuY3JlYXRlQ2hhbmdlU2V0KCk7XG4gICAgdGhpcy5wZW5kaW5nRW50aXR5UmVhZExpbmtPcmRpbmFsU3VmZml4ID0gMDtcbiAgfVxuXG4gIHB1YmxpYyBjYW5jZWxDaGFuZ2VTZXQoKTogdm9pZCB7XG4gICAgdGhpcy5wZW5kaW5nQ2hhbmdlU2V0ID0gbnVsbDtcbiAgICB0aGlzLnBlbmRpbmdFbnRpdHlSZWFkTGlua09yZGluYWxTdWZmaXggPSAwO1xuICB9XG5cbiAgcHVibGljIGNvbW1pdENoYW5nZVNldCgpOiB2b2lkIHtcbiAgICBsZXQgY2hhbmdlU2V0ID0gdGhpcy5wZW5kaW5nQ2hhbmdlU2V0O1xuICAgIGlmIChjaGFuZ2VTZXQgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKEVycm9yTWVzc2FnZS5PREFUQV9DT01NSVRfRU1QVFlfQ0hBTkdFU0VUX05PVF9BTExPV0VEKTtcbiAgICB9XG5cbiAgICB0aGlzLnBlbmRpbmdDaGFuZ2VTZXQgPSBudWxsO1xuICAgIHRoaXMucGVuZGluZ0VudGl0eVJlYWRMaW5rT3JkaW5hbFN1ZmZpeCA9IDA7XG4gICAgdGhpcy5wcm9jZXNzQmF0Y2hXaXRoQ2hhbmdlU2V0KGNoYW5nZVNldCk7XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlRW50aXR5KGVudGl0eTogYW55LCBoZWFkZXJzOiBhbnkpOiB2b2lkIHtcbiAgICBsZXQgY2hhbmdlU2V0ID0gdGhpcy5wZW5kaW5nQ2hhbmdlU2V0O1xuICAgIGlmIChjaGFuZ2VTZXQgIT0gbnVsbCkge1xuICAgICAgdGhpcy5wZW5kaW5nRW50aXR5UmVhZExpbmtPcmRpbmFsU3VmZml4ICs9IDE7XG4gICAgICBlbnRpdHkuc2V0UmVhZExpbmsoQ2hhbmdlU2V0TWFuYWdlci5VTlBST0NFU1NFRFBSRUZJWCArIHRoaXMucGVuZGluZ0VudGl0eVJlYWRMaW5rT3JkaW5hbFN1ZmZpeCk7XG4gICAgICBjaGFuZ2VTZXQuY3JlYXRlRW50aXR5KGVudGl0eSwgaGVhZGVycyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2VydmljZS5jcmVhdGVFbnRpdHkoZW50aXR5LCBoZWFkZXJzKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlUmVsYXRlZEVudGl0eShlbnRpdHk6IGFueSwgcGFyZW50RW50aXR5OiBhbnksIHBhcmVudE5hdlByb3A6IGFueSwgaGVhZGVyczogYW55KTogdm9pZCB7XG4gICAgbGV0IGNoYW5nZVNldCA9IHRoaXMucGVuZGluZ0NoYW5nZVNldDtcbiAgICBpZiAoY2hhbmdlU2V0ICE9IG51bGwpIHtcbiAgICAgIHRoaXMucGVuZGluZ0VudGl0eVJlYWRMaW5rT3JkaW5hbFN1ZmZpeCArPSAxO1xuICAgICAgZW50aXR5LnNldFJlYWRMaW5rKENoYW5nZVNldE1hbmFnZXIuVU5QUk9DRVNTRURQUkVGSVggKyB0aGlzLnBlbmRpbmdFbnRpdHlSZWFkTGlua09yZGluYWxTdWZmaXgpO1xuICAgICAgY2hhbmdlU2V0LmNyZWF0ZVJlbGF0ZWRFbnRpdHkoZW50aXR5LCBwYXJlbnRFbnRpdHksIHBhcmVudE5hdlByb3AsIGhlYWRlcnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNlcnZpY2UuY3JlYXRlUmVsYXRlZEVudGl0eShlbnRpdHksIHBhcmVudEVudGl0eSwgcGFyZW50TmF2UHJvcCwgaGVhZGVycyk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHVwZGF0ZUVudGl0eShlbnRpdHk6IGFueSwgaGVhZGVyczogYW55KTogdm9pZCB7XG4gICAgbGV0IGNoYW5nZVNldCA9IHRoaXMucGVuZGluZ0NoYW5nZVNldDtcbiAgICBpZiAoY2hhbmdlU2V0ICE9IG51bGwpIHtcbiAgICAgIGNoYW5nZVNldC51cGRhdGVFbnRpdHkoZW50aXR5LCBoZWFkZXJzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXJ2aWNlLnVwZGF0ZUVudGl0eShlbnRpdHksIGhlYWRlcnMpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBkZWxldGVFbnRpdHkoZW50aXR5OiBhbnksIGhlYWRlcnM6IGFueSk6IHZvaWQge1xuICAgIGxldCBjaGFuZ2VTZXQgPSB0aGlzLnBlbmRpbmdDaGFuZ2VTZXQ7XG4gICAgaWYgKGNoYW5nZVNldCAhPSBudWxsKSB7XG4gICAgICBjaGFuZ2VTZXQuZGVsZXRlRW50aXR5KGVudGl0eSwgaGVhZGVycyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2VydmljZS5kZWxldGVFbnRpdHkoZW50aXR5LCBoZWFkZXJzKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgcGVuZGluZ0VudGl0eUZyb21QZW5kaW5nQ2hhbmdlU2V0KHJlYWRMaW5rOiBzdHJpbmcpOiBhbnkge1xuICAgIGlmICghcmVhZExpbmsuc3RhcnRzV2l0aChDaGFuZ2VTZXRNYW5hZ2VyLlVOUFJPQ0VTU0VEUFJFRklYKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBPRGF0YUhlbHBlci5lbnRpdHlXaXRoUmVhZExpbmsodGhpcy5wZW5kaW5nQ2hhbmdlU2V0LCByZWFkTGluayk7XG4gIH1cblxuICBwcml2YXRlIHByb2Nlc3NCYXRjaFdpdGhDaGFuZ2VTZXQoY2hhbmdlU2V0OiBhbnkpOiB2b2lkIHtcbiAgICBsZXQgcmVxdWVzdEJhdGNoID0gT0RhdGFIZWxwZXIuY3JlYXRlUmVxdWVzdEJhdGNoKCk7XG4gICAgcmVxdWVzdEJhdGNoLmFkZENoYW5nZXMoY2hhbmdlU2V0KTtcblxuICAgIHRoaXMuc2VydmljZS5wcm9jZXNzQmF0Y2gocmVxdWVzdEJhdGNoKTtcbiAgICBsZXQgZXJyb3IgPSBjaGFuZ2VTZXQuZ2V0RXJyb3IoKTtcbiAgICBpZiAoZXJyb3IgIT0gbnVsbCkge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG59XG4iXX0=